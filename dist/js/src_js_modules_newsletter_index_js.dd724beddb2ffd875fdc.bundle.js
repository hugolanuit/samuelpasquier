"use strict";(self.webpackChunksamuelpasquier=self.webpackChunksamuelpasquier||[]).push([["src_js_modules_newsletter_index_js"],{"./src/js/modules/module/Module.js":(t,e,i)=>{function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(e,{Z:()=>s});const s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,s;return e=t,(i=[{key:"init",value:function(){}},{key:"start",value:function(){}},{key:"stop",value:function(){}},{key:"destroy",value:function(){}},{key:"name",get:function(){return null}}])&&n(e.prototype,i),s&&n(e,s),t}()},"./src/js/modules/newsletter/index.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>C,instance:()=>O});var n=i("./src/js/utils/dom.js"),s=i("./src/js/modules/module/Module.js"),r=i("./node_modules/axios/index.js"),o=i.n(r),u=i("./node_modules/form-serialize/index.js"),l=i.n(u),a=i("./src/js/utils/listener.js");function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var h="--filled",f="--validation-reported",m="--wp-success",p="--wp-error",_=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.form=(0,n.$)(".newsletter__form",this.el),this.input=(0,n.$)(".newsletter__form__input",this.form),this.btn=(0,n.$)(".newsletter__form__submit",this.form),this.output=(0,n.$)(".newsletter__form__output",this.form),this._waiting=!1,this._timer=null,this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onSubmit=this._onSubmit.bind(this),this._onSubmitCallback=this._onSubmitCallback.bind(this),this._onSubmitError=this._onSubmitError.bind(this),this._onReset=this._onReset.bind(this),this._send=this._send.bind(this),this._removeOutputMessage=this._removeOutputMessage.bind(this),this.init()}var e,i,s;return e=t,i=[{key:"init",value:function(){this.input&&((0,a.on)(this.input,"focus",this._onFocus),(0,a.on)(this.input,"blur",this._onBlur),this.input.value.trim()&&this._onFocus()),this.form&&((0,a.on)(this.form,"submit",this._onSubmit),(0,a.on)(this.form,"reset",this._onReset))}},{key:"destroy",value:function(){this.input&&((0,a.S1)(this.input,"focus",this._onFocus),(0,a.S1)(this.input,"blur",this._onBlur)),this.form&&((0,a.S1)(this.form,"submit",this._onSubmit),(0,a.S1)(this.form,"reset",this._onReset)),this.el=null,this.form=null,this.input=null,this.btn=null,this.output=null,this._onFocus=null,this._onBlur=null,this._onSubmit=null,this._onSubmitCallback=null,this._onSubmitError=null,this._onReset=null,this._send=null,this._removeOutputMessage=null}},{key:"_onFocus",value:function(){this._timer&&clearTimeout(this._timer),this._timer=null,this.form.classList.contains(m)&&(this.form.classList.remove(m),this.output&&(this.output.innerHTML="")),this.form.classList.add(h)}},{key:"_onBlur",value:function(){this.input&&this.input.value.trim()||this.form.classList.remove(h)}},{key:"_onSubmit",value:function(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),this.form.classList.contains(m)||this.form.classList.remove(m),this.form.classList.contains(f)||this.form.classList.add(f),this.form.reportValidity&&!this.form.reportValidity()||!0===this._waiting||(this._waiting=!0,this._timer&&clearTimeout(this._timer),this._timer=null,this.btn&&this.btn.setAttribute("disabled",!0),this.output&&(this.output.classList.remove(p),this.output.innerHTML=""),window.grecaptcha&&window.reCAPTCHA_SITE_KEY?window.grecaptcha.execute(window.reCAPTCHA_SITE_KEY,{action:"newsletter"}).then(this._send):this._send()),!1}},{key:"_onSubmitCallback",value:function(t){var e=t.data,i=e.success,n=e.message,s=e.errors;i&&(this.form.classList.remove(f),this.form.classList.add(m),this.form.reset()),n&&this.output&&!s&&(i||this.output.classList.add(p),this.output.innerHTML=n,i&&(this._timer=setTimeout(this._removeOutputMessage,5e3))),this.btn&&this.btn.removeAttribute("disabled"),this._waiting=!1}},{key:"_onSubmitError",value:function(t){this.output&&(this.output.classList.add(p),this.output.innerHTML=t),this.form.classList.remove(f),this.btn&&this.btn.removeAttribute("disabled"),this._waiting=!1}},{key:"_onReset",value:function(){this._onBlur()}},{key:"_send",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.form.getAttribute("action"),i=l()(this.form);t&&(i+="&".concat(encodeURIComponent("reCAPTCHA"),"=").concat(encodeURIComponent(t))),o().post(e,i).then(this._onSubmitCallback).catch(this._onSubmitError)}},{key:"_removeOutputMessage",value:function(){this._timer&&clearTimeout(this._timer),this._timer=null,this.form&&this.form.classList.remove(h,m),this.output&&(this.output.innerHTML="")}}],i&&c(e.prototype,i),s&&c(e,s),t}();const d=_;function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function g(t,e){return!e||"object"!==j(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t,e){return k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},k(t,e)}function S(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return b(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return b(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var j=function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=w(t);if(e){var s=w(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return g(this,i)}}var O=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(o,t);var e,i,s,r=L(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return y(this,o),(t=r.call(this)).initialized=!1,t.items=null,e&&t.init(),t}return e=o,(i=[{key:"name",get:function(){return"Newsletter"}},{key:"init",value:function(){var t=this;this.initialized=!0,this.items=S((0,n.$$)("[data-newsletter]")).map((function(e){return new d(e,t.emitter)}))}},{key:"destroy",value:function(){this.items&&this.items.forEach((function(t){return t.destroy()})),this.initialized=!1,this.items=null}}])&&v(e.prototype,i),s&&v(e,s),o}(s.Z));const C={instance:O}}}]);
//# sourceMappingURL=src_js_modules_newsletter_index_js.dd724beddb2ffd875fdc.bundle.js.map